# A Happy Union
---
### Question
I really need access to website, but I forgot my password and there is no reset. Can you help? I like lite sql :)

### HINTS

A SQL union allows a single query to select values from multiples tables.

---
# Solution

SQL Injection is one of my favourite topic but of course sometimes i lack in sql injection too. Anyways here in this challenge we got one [website](http://shell2017.picoctf.com:23598/) link. 

If you don't know what is Sql Injection then watch these [TUTORIALS](https://www.youtube.com/c/Pentestingwithspirit).

So, lets start

1. Our Login form looks like this.
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/1-login.png?raw=true)

2. Our registration form looks like this.
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/1-reg.png?raw=true)
3. Now lets try to make account with ```username & password``` with single quote i.e: ```'``` .
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/2.png?raw=true)

Just ```Click on Register``` and Login with ```'```
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/2-login.png?raw=true)

Out Login will look like this:- 
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/2-view.png?raw=true)

Oops we got an error. Lets try to Balance the query, 
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/3.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/3-login.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/3-view.png?raw=true)

So, Our query is balanced. Now lets find the total number of columns.
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/4.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/4-login.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/4-view.png?raw=true)

No 4 is not, lets decrease the ```4``` to ```3```
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/5.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/5-login.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/5-view.png?raw=true)

Okay! So their are total 3 number of columns. Now lets check which column is vulnerable. 
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/6.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/6-login.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/6-view.png?raw=true)

Okay all three seems to be vulnerable. Now lets see the tables and their representative column name. 
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/7.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/7-login.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/7-view.png?raw=true)

Okay so table:```users``` seems intresting which contains ```user, pass``` columns. Lets dump it
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/final-reg.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/final-register.png?raw=true)
![](https://github.com/iammrdollar/picoctf-2017-write-up/blob/master/Level%203/WEB-EXPLOITATION/images/final.png?raw=true)


 So, i think we got the flag 
 ```
 flag{union?_why_not_onion_a69464d4869c743e26c08df8686e4003} 
 ```
 
 Hope you liked it :)
 
   ~Thanks
   
   [@spiritedwolf](https://github.com/spiritedwolf)

---

